<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"
    />

    <title>Shining Light on the Shadow DOM</title>

    <link rel="stylesheet" href="css/reset.css" />
    <link rel="stylesheet" href="css/reveal.css" />
    <link rel="stylesheet" href="css/theme/mytheme.css" />

    <!-- Theme used for syntax highlighting of code -->
    <link rel="stylesheet" href="lib/css/monokai.css" />

    <!-- Printing and PDF exports -->
    <script>
      var link = document.createElement("link");
      link.rel = "stylesheet";
      link.type = "text/css";
      link.href = window.location.search.match(/print-pdf/gi)
        ? "css/print/pdf.css"
        : "css/print/paper.css";
      document.getElementsByTagName("head")[0].appendChild(link);
    </script>
  </head>
  <body>
    <div class="reveal">
      <footer>
        <span class="name">@robindykema</span>
      </footer>
      <div class="slides">
        <section data-background="./assets/introslide.jpg"></section>
        <section>
          <img
            class="circular-image"
            src="./assets/me.png"
            alt="Robin Dykema"
          />
          <h2>Hello!</h2>
          <p>I’m Robin Dykema.</p>
          <p>I’m a UI engineer at Taulia in Austin, TX.</p>
        </section>
        <section>
          <h2>What we will cover today</h2>
          <ol>
            <li class="fragment">A background of the shadow DOM</li>
            <li class="fragment">What is the shadow DOM?</li>
            <li class="fragment">Shadow DOM examples</li>
            <li class="fragment">How to use the shadow DOM</li>
          </ol>
        </section>

        <!-- Part 1 begins -->
        <section>
          <section><h1>Background of the shadow DOM</h1></section>
          <section>
            <h2>The shadow DOM is part of the Web Component standards.</h2>
          </section>
          <section>
            <p>
              Web components are framework-agnostic components that can be
              dropped into any app. They use native JavaScript and do not
              require any outside libraries.
            </p>
            <p class="fragment">
              They're compatible with current
              <span style="font-style: italic">and future </span>frameworks.
            </p>
          </section>
        </section>
        <section>
          <section>
            <h2>
              Web components consist of four separate technologies that can be
              used together
            </h2>
            <ol>
              <li class="fragment">Custom elements</li>
              <li class="fragment">Shadow DOM</li>
              <li class="fragment">HTML templates</li>
              <li class="fragment">ES Modules</li>
            </ol>
            <p class="fragment">You can use them together or separately.</p>
          </section>
          <section>
            <h2>Example use case for web components</h2>
            <p>
              Let's say we have a Vue repository and React repository, and we
              want the tooltips to look and act the same in both repositories.
            </p>
          </section>
          <section>
            <h2>Potential problems</h2>
            <ol>
              <li class="fragment">You have to coordinate between 2+ teams</li>
              <li class="fragment">
                One team's tooltip looks/acts differently
              </li>
              <li class="fragment">
                Your designer updates the look, and now you have to update it in
                two spots
              </li>
            </ol>
          </section>
          <section>
            <h2>Let's create a tooltip using web components!</h2>
            <p>
              We create the markup, logic, and styling once, and export it to be
              used in both repositories.
            </p>
          </section>
          <section>
            <pre>
              <code class="hljs">
  class Tooltip extends HTMLElement {
    constructor() { ... }
    connectedCallback() { ... }
    _render() { ... }
    disconnectedCallback() { ... }
    attributeChangedCallback(name, oldValue, newValue) { ... }
    _showTooltip() { ... }
    _hideTooltip() { ... }
  }
  
  customElements.define("robins-tooltip", Tooltip);
            </code>
            </pre>
          </section>
          <section>
            <pre>
              <code class="hljs">
  <script src="tooltip.js"></script>

  ...

  <robins-tooltip theme="dark">
    <span>My tooltip!</span>
  </robins-tooltip>
              </code>
            </pre>
          </section>
          <section>
            <h2>Web components are</h2>
            <ul>
              <li class="fragment">Reusable</li>
              <li class="fragment">Future proof</li>
              <li class="fragment">
                A way to help share code between React and Angular code bases
              </li>
              <li class="fragment">Highly configurable</li>
            </ul>
          </section>
          <section>
            <h2>Web components are not</h2>
            <ul>
              <li class="fragment">A framework</li>
              <li class="fragment">A rendering library</li>
              <li class="fragment">Opinionated</li>
              <li class="fragment">Going to replace React/Angular/Vue/____</li>
            </ul>
          </section>
          <section>
            <p>Libraries of already built web components:</p>
            <ul>
              <li>
                <a
                  target="_blank"
                  href="https://github.com/material-components/material-components-web-components"
                  rel="noopener"
                  >Material Web Components</a
                >
              </li>
              <li>
                <a
                  target="_blank"
                  href="https://www.webcomponents.org/author/PolymerElements"
                  rel="noopener"
                  >PolymerElements</a
                >
              </li>
              <li>
                <a
                  target="_blank"
                  href="https://github.com/vaadin/vaadin"
                  rel="noopener"
                  >Vaadin</a
                >
              </li>
              <li>
                <a target="_blank" href="https://wiredjs.com/" rel="noopener"
                  >Wired</a
                >
              </li>
            </ul>
          </section>
        </section>
        <section>
          <section><h2>Browser support</h2></section>
          <section>
            <img alt="browser support" src="./assets/browser-support.png" />
          </section>
          <section>
            <p>Yes, you will need a polyfill if you want to support IE11.</p>
          </section>
        </section>
        <!-- Part 2 begins -->
        <section>
          <section>
            <h2>
              You can write a component without using the shadow DOM and you can
              use the shadow DOM without writing a single component.
            </h2>
          </section>
        </section>
        <section>
          <section><h1>What is the shadow DOM?</h1></section>
          <section>
            <img
              class="width-50"
              alt="Creepy shadow ghost"
              src="./assets/ghost.jpg"
            />
            <img
              class="width-50"
              alt="Scared cat"
              src="./assets/scaredcat.gif"
            />
          </section>
          <section>
            <img
              class="width-50"
              alt="Shadow monster from Stranger Things"
              src="./assets/strangerthings.jpg"
            />
            <img
              class="width-50"
              alt="Stranger Things 2 logo"
              src="./assets/strangerthings2.gif"
            />
          </section>
          <section>
            <p>The shadow DOM is not that scary, I promise.</p>
          </section>
        </section>
        <section>
          <section>
            <h2>Before we answer what the shadow DOM is... what is the DOM?</h2>
            <p class="fragment">And the light DOM?</p>
            <p class="fragment">And the virtual DOM?</p>
            <p class="fragment">HOW MANY DOMS ARE THERE?!?</p>
          </section>
          <section>
            <img
              class="width-50"
              alt="Meme about too many DOMs"
              src="./assets/dommeme.jpeg"
            />
            <img
              class="width-50"
              alt="Recursion"
              src="./assets/recursive.gif"
            />
          </section>
          <section>
            <h2>Shadow DOM ≠ the DOM.</h2>
            <h2 class="fragment">Shadow DOM ≠ virtual DOM.</h2>
            <h2 class="fragment">The DOM = the light DOM.</h2>
          </section>
          <section>
            <h2>Types of DOMs</h2>
            <ol>
              <li>The DOM / light DOM</li>
              <li>Virtual DOM</li>
              <li>Shadow DOM</li>
            </ol>
          </section>
          <section>
            <h2>The DOM (Document Object Model)</h2>
            <img alt="diagram of DOM" src="./assets/dom-diagram.svg" />
          </section>
          <section>
            <p>
              The DOM is also known as the light DOM when used in comparison to
              the shadow DOM.
            </p>
            <img alt="star wars light/dark" src="./assets/starwars.jpg" />
          </section>
          <section>
            <h2>Virtual DOM</h2>
            <img
              class="width-50"
              alt="virtual dom diagram"
              src="./assets/virtual-dom.png"
            />
            <small
              >Source:
              https://www.oreilly.com/library/view/learning-react-native/9781491929049/ch02.html</small
            >
          </section>
        </section>
        <section>
          <section>
            <h1>What is the shadow DOM?</h1>
          </section>
          <section>
            <h2>
              The shadow DOM is a web API that lets you attach a hidden DOM
              element to a DOM element.
            </h2>
          </section>
          <section>
            <h2>Encapsulation.</h2>
            <p class="fragment">
              The shadow DOM is hidden from the rest of the DOM.
            </p>
            <p class="fragment">
              No CSS, markup, or logic can leak into the shadow DOM from the
              rest of the DOM.
            </p>
          </section>
          <section>
            <h2>Light DOM and Shadow DOM</h2>
            <img
              alt="shadow dom diagram"
              src="./assets/shadowdom-diagram.svg"
            />
          </section>

          <section>
            <h2>Example use case for the shadow DOM</h2>
            <p>
              Remember the tooltip we created to share between our Vue and React
              repositories?
            </p>
          </section>
          <section>
            <pre>
              <code class="hljs">
  class Tooltip extends HTMLElement {
    constructor() { ... }
    connectedCallback() { ... }
    _render() { ... }
    disconnectedCallback() { ... }
    attributeChangedCallback(name, oldValue, newValue) { ... }
    _showTooltip() { ... }
    _hideTooltip() { ... }
  }
  
  customElements.define("robins-tooltip", Tooltip);
            </code>
            </pre>
          </section>
          <section>
            <h2>Potential CSS problems</h2>
            <ol>
              <li class="fragment">
                The CSS is a mess in one repository and has leaked into the
                tooltip
              </li>
              <li class="fragment">
                One repository uses a lot of outside libraries, and the CSS from
                those libraries has interfered with our tooltip styling
              </li>
            </ol>
          </section>
          <section>
            <p>
              We can use the shadow DOM to make sure the tooltip is isolated
              from the rest of the code base.
            </p>
            <p>
              No CSS or JavaScript from the other repositories can touch the
              tooltip. We will have all the control over how it acts and looks
              like.
            </p>
          </section>
          <section>
            <h2>Shadow DOM</h2>
            <p class="fragment">
              The shadow DOM is like a DOM within the (light) DOM.
            </p>
            <p class="fragment">
              Without the (light) DOM, a shadow DOM cannot exist.
            </p>
            <p class="fragment">
              Think of it as a scoped subtree with its own elements and styles.
            </p>
            <p class="fragment">
              The shadow DOM nodes are completely isolated from the (light) DOM.
            </p>
          </section>
        </section>

        <section>
          <section><h2>The shadow DOM simplifies CSS.</h2></section>
          <section>
            <p>The shadow DOM simplifies CSS by letting you:</p>
            <ul>
              <li class="fragment">use simple CSS selectors</li>
            </ul>
          </section>
          <section data-transition="zoom">
            <pre>
              <code class="hljs">
div.main > div ~ #main ul li.selected > a[href*=”li-”] + span.lg {
  background-color: white;
}
            </code>
          </pre>
          </section>
          <section data-transition="zoom">
            <pre>
              <code class="hljs">
span {
  background-color: white;
}
            </code>
          </pre>
          </section>
          <section>
            <p>The shadow DOM simplifies CSS by letting you:</p>
            <ul>
              <li>use simple CSS selectors</li>
              <li class="fragment">use more generic id/class names</li>
            </ul>
          </section>
          <section>
            <pre>
              <code class="hljs">
<div class="priority"></div>

<div class="copyright"></div>

<div class="success"></div>
            </code>
          </pre>
          </section>
          <section>
            <p>The shadow DOM simplifies CSS by letting you:</p>
            <ul>
              <li>use simple CSS selectors</li>
              <li>use more generic id/class names</li>
              <li class="fragment">not worry about naming conflicts</li>
            </ul>
          </section>
          <section>
            <p>
              You can use Bootstrap
              <span style="font-style: italic">and</span> name a class
              "container"!
            </p>
          </section>
        </section>

        <!-- HTML Elements with shadow DOM -->
        <section>
          <section>
            <h2>Shadow DOM examples</h2>
          </section>
          <section>
            <h2>
              Several HTML elements you already use utilize the shadow DOM.
            </h2>
          </section>
          <section>
            <h2>input type="range"</h2>
            <img alt="input range gif" src="./assets/input.gif" />
          </section>
          <section>
            <h2>input type="range"</h2>
            <img
              alt="html of input range with no shadow dom"
              src="./assets/inputrange2.png"
            />
          </section>
          <section>
            <img
              alt="gif showing how to set up shadow dom"
              src="./assets/devtools.gif"
            />
            <p>Dev tools -> settings -> show user agent shadow DOM</p>
          </section>
          <section>
            <h2>input type="range"</h2>
            <img
              alt="html of input range with shadow dom"
              src="./assets/inputrange3.png"
            />
          </section>
          <section>
            <h2>video</h2>
            <img alt="html of video" src="./assets/video.png" />
          </section>
        </section>
        <section>
          <section><h2>Shadow DOM vocabulary lesson</h2></section>
          <section>
            <ul>
              <li>
                <span class="yellow-font">Shadow host:</span>
                The light DOM node that the shadow DOM is attached to
              </li>
              <li class="fragment">
                <span class="yellow-font">Shadow tree:</span> The DOM tree
                inside the shadow DOM
              </li>
              <li class="fragment">
                <span class="yellow-font">Shadow boundary:</span> The place
                where the shadow DOM ends, and the light DOM begins
              </li>
              <li class="fragment">
                <span class="yellow-font">Shadow root:</span> The root node of
                the shadow tree
              </li>
            </ul>
          </section>
          <section>
            <img
              alt="shadow dom diagram"
              src="./assets/shadowdom-diagram.png"
            />
            <small
              >Source:
              https://developer.mozilla.org/en-US/docs/Web/Web_Components/Using_shadow_DOM</small
            >
          </section>
          <section>
            <p>
              Note: Multiple shadow DOMs can exist in the document, and can even
              be nested. But, each node can only host one shadow root.
            </p>
          </section>
        </section>

        <!-- CODE -->
        <section>
          <section><h1>Let's write some code!</h1></section>
          <section>
            <h2>Element.attachShadow</h2>
            <p>
              The Element.attachShadow() method attaches a shadow DOM tree to
              the specified element and returns a reference to its ShadowRoot.
            </p>
          </section>
          <section>
            <h2>Element.attachShadow</h2>
            <img
              alt="attachShadow browser support"
              src="./assets/attachShadow.png"
            />
          </section>
          <section>
            <h2>Regular HTML & CSS in light DOM</h2>
            <img alt="html and css code" src="./assets/code1.png" />
          </section>
          <section>
            <h2>Add the shadow DOM using JavaScript</h2>
            <pre>
              <code class="hljs">
// Create shadow host (in light DOM)
const shadowHost = document.createElement('div');

// Create shadow root and attach to shadow host
const shadowRoot = shadowHost.attachShadow({ mode: 'open' });
shadowRoot.innerHTML = '<p>Hi, I am in the shadow DOM!</p>'

// Attach shadow host to the body
const container = document.querySelector('body');
container.appendChild(shadowHost);
              </code>
            </pre>
          </section>
          <section>
            <h2>Add in the shadow DOM</h2>
            <img alt="html, js and css code" src="./assets/code2.png" />
          </section>
          <section>
            <h2>Inspect element</h2>
            <img alt="html, js and css code" src="./assets/code3.png" />
          </section>
          <section>
            <h2>Add style to shadow DOM using JavaScript</h2>
            <pre>
              <code class="hljs">
// Create shadow host (in light DOM)
const shadowHost = document.createElement('div');

// Create shadow root and attach to shadow host
const shadowRoot = shadowHost.attachShadow({ mode: 'open' });
shadowRoot.innerHTML = '<p>Hi, I am in the shadow DOM!</p>'

// Attach shadow host to the body
const container = document.querySelector('body');
container.appendChild(shadowHost);

// Style the shadow DOM
const style = document.createElement('style');
style.textContent = `
  p {
    text-decoration: underline;
  }
`
shadowRoot.appendChild(style)
              </code>
            </pre>
          </section>
          <section>
            <h2>Add style in the shadow DOM</h2>
            <img alt="html, js and css code" src="./assets/code4.png" />
          </section>
          <section>
            <h2>Quiz!</h2>
            <p>What will this code return?</p>
            <pre>
              <code class="hljs">document.querySelectorAll('p').length => ???</code>
            </pre>
            <img alt="html, js and css code" src="./assets/code3.png" />
          </section>
          <section>
            <h2>Quiz!</h2>
            <p>What will this code return?</p>
            <p>1</p>
            <pre>
              <code class="hljs">document.querySelectorAll('p').length => 1</code>
            </pre>
            <img alt="html, js and css code" src="./assets/code3.png" />
          </section>
        </section>

        <section>
          <section><h2>A note on accessibility...</h2></section>
          <section>
            <p>
              For those using assistive technologies to read web pages, the
              entire document (shadow and light DOM) is read as rendered, as one
              tree.
            </p>
          </section>
        </section>
        <!-- TODO: final takeaways for shadow dom -->
        <section>
          <h2>Final takeaways</h2>
          <ol>
            <li class="fragment">
              The shadow DOM is part of the web components specifications
            </li>
            <li class="fragment">The shadow DOM</li>
            <li class="fragment">Takeaway 3</li>
          </ol>
        </section>
        <section>
          <h1>Thanks!</h1>
          <p>
            Message me or find my slides (with additional resources) on Twitter
            at
          </p>
          <h3>@robindykema</h3>
        </section>
        <section>
          <section>
            <h1>Resources</h1>
          </section>
          <section>
            <ul>
              <li>
                <a
                  rel="noopener"
                  target="_blank"
                  href="https://www.webcomponents.org/"
                  >webcomponents.org</a
                >
              </li>
              <li>
                Google web fundamentals:
                <a
                  rel="noopener"
                  target="_blank"
                  href="https://developers.google.com/web/fundamentals/web-components"
                  >Web components</a
                >
              </li>
              <li>
                <a
                  href="https://github.com/mateusortiz/webcomponents-the-right-way#best-practices"
                  rel="noopner"
                  target="_blank"
                  >Web Components the Right Way</a
                >: A curated list of awesome web components resources
              </li>
              <li>
                <a
                  href="https://hacks.mozilla.org/2018/03/es-modules-a-cartoon-deep-dive/"
                  rel="noopener"
                  target="_blank"
                  >ES modules: A cartoon deep dive</a
                >
              </li>
              <li>
                MDN Docs:
                <a
                  href="https://developer.mozilla.org/en-US/docs/Web/API/Document_Object_Model/Introduction"
                  rel="noopener"
                  target="_blank"
                  >Introduction to the DOM</a
                >
              </li>
              <li>
                MDN Docs:
                <a
                  href="https://developer.mozilla.org/en-US/docs/Web/Web_Components/Using_shadow_DOM"
                  rel="noopener"
                  target="_blank"
                  >Using the shadow DOM</a
                >
              </li>
            </ul>
          </section>
        </section>
      </div>
    </div>

    <script src="js/reveal.js"></script>

    <script>
      // More info about config & dependencies:
      // - https://github.com/hakimel/reveal.js#configuration
      // - https://github.com/hakimel/reveal.js#dependencies
      Reveal.initialize({
        hash: true,
        dependencies: [
          { src: "plugin/markdown/marked.js" },
          { src: "plugin/markdown/markdown.js" },
          { src: "plugin/highlight/highlight.js" },
          { src: "plugin/notes/notes.js", async: true },
        ],
      });
    </script>
  </body>
</html>

<!-- <section>
            <h3>
              You probably already use web components on a daily basis, whether
              you realize it or not.
            </h3>
            <p>
              <span class="fragment">Github, </span>
              <span class="fragment">Youtube, </span>
              <span class="fragment">any site using AMP</span>
            </p>
          </section> -->

<!--           <section>
            <p>
              While it's certainly possible to create an entire application
              using only web components and vanilla JS, for complex
              applications, you might be better off using React/Angular/etc for
              heavy lifting.
            </p>
          </section> -->
